# 專案規格書：BlogMix 重生計畫 (Project Specification)

## 1. 專案概觀 (Project Overview)
**BlogMix** 是一個結合內容管理系統 (CMS) 與電子商務的混合平台。它整合了豐富的部落格內容與購物體驗，允許使用者瀏覽文章、購買相關商品（或文章本身即為商品），並透過會員系統與平台互動。

本計畫的目標是使用現代網頁技術重構此 2016 年的舊應用程式，在改善關鍵架構缺陷的同時，保留原有的商業邏輯。

## 2. 使用者角色 (User Roles)

### 2.1 訪客 (Guest)
- **瀏覽內容**：查看文章列表、閱讀單篇文章。
- **搜尋**：搜尋文章或商品。
- **購物車**：將商品加入臨時購物車（結帳需登入）。
- **身份驗證**：
    - 註冊新帳號、登入。
    - **登入驗證**：整合 Cloudflare Turnstile (免費、隱私友善) 或 Google reCAPTCHA v3，防止機器人攻擊。

### 2.2 會員 (Member)
- **個人資料管理**：更新個人資訊、查看購買紀錄。
- **購物車與結帳**：管理購物車項目、進行結帳（Step 1-4 流程）。
- **客戶服務**：透過「客服提問 (Service List)」功能提問，並查看管理員回覆。
- **訂單追蹤**：查看歷史訂單狀態。

### 2.3 管理員 (Admin)
- **儀表板**：系統狀態總覽。
- **文章管理**：文章的 CRUD（標題、內容、分類、價格）。
    - *注意*：在此系統中，文章 (Article) 同時也具有商品 (Product) 的功能。
- **分類管理**：管理文章的主分類與子分類。
- **訂單管理**：查看與更新訂單狀態。
- **會員管理**：列表與管理使用者帳號。
- **客服管理**：回覆使用者的詢問。
- **系統配置**：管理廣告連結、SEO 設定。

## 3. 核心功能 (Core Features)

### 3.1 內容引擎 (Blog)
- **分類系統**：階層式分類（主分類 -> 子分類）。
- **文章展示**：Rich Text 內容、瀏覽數統計、發布日期。
- **排行榜**：顯示熱門瀏覽或評價最高的內容 ("Ranklist")。

### 3.2 電商引擎 (E-Commerce)
- **商品模型**：文章被視為可購買的項目。
- **購物車**：
    - 新增/移除項目。
    - 更新數量。
    - 登入使用者的購物車內容需持久化保存。
- **結帳流程**：
    - 步驟 1：購物車確認 (Cart Review)。
    - 步驟 2：填寫配送資訊 (收件人、電話、地址)。
    - 步驟 3：付款 (Payment)。
        - 建議整合 **綠界科技 (ECPay)**：台灣市佔率高，文件完整，適合一般電商。
        - 選項：**LinePay** (行動支付首選) 或 **Stripe** (若需國際化)。
        - *本階段優先實作 ECPay SDK 或 API 串接。*
    - 步驟 4：完成訂單與發票顯示。

### 3.3 客戶服務 (Service List)
- 票務系統 (Ticketing System)，使用者可張貼問題 (`slist_theme`, `slist_question`)。
- 管理員回覆 (`slist_response`)，將狀態從「未回覆」變更為「已回覆」。

## 4. 使用者流程 (User Flows)

### 4.1 結帳流程
1.  **購物車**：使用者確認購買項目。
2.  **權限檢查**：若未登入，導向登入頁面。
3.  **資訊輸入**：使用者填寫收件人詳細資訊。
4.  **建立訂單**：系統建立連結至 `Member` 的 `Order`。項目從 `Cart` 移動至 `OrderItems`。
5.  **付款**：使用者被導向至第三方金流閘道。
6.  **回調 (Callback)**：金流閘道通知系統付款結果（訂單完成）。

### 4.2 客服提問流程
1.  會員進入「新增提問 (Add Service)」。
2.  填寫主旨與內容。
3.  系統儲存提問，狀態設為「處理中/未回覆」。
4.  管理員在後台看到提問。
5.  管理員進行回覆。
6.  會員在「客服紀錄」中看到回覆內容。
